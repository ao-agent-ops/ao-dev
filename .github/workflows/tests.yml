name: Pytest

on:
  push:
  workflow_dispatch:
  issue_comment:
    types: [created]

jobs:
  debug-billable:
    name: Debug Billable Trigger
    if: github.event_name == 'issue_comment'
    runs-on: ubuntu-latest
    steps:
      - name: Dump context
        run: |
          echo "Is PR: ${{ github.event.issue.pull_request }}"
          echo "Comment body: ${{ github.event.comment.body }}"
          echo "Contains trigger: ${{ contains(github.event.comment.body, '/run-billable-tests') }}"

  billable-permission-check:
    name: Billable Tests / Permission Check
    if: |
      github.event_name == 'issue_comment' &&
      github.event.issue.pull_request != null &&
      contains(github.event.comment.body, '/run-billable-tests')
    runs-on: ubuntu-latest
    steps:
      - name: Placeholder
        run: echo "Permission check would go here"
